<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>#game{display:block;background:#b90000;width:100vw;height:100vh}</style>
    <title>Rainbow friends</title>
</head>
<body>
    <canvas id='game'></canvas>
<script>
//WASD movement

let endscreen=new Image()
endscreen.src='../images/RanbowFwens_end.png'
const bg=new Image();
bg.src='../images/RanbowFwens_Thumbnail.png';
let end=0;let ded=0;let enemy='blue';let timer=1800;let border=1;
images();
setTimeout(() => {
let UserName='';
        UserName=prompt('Who has returned here?');
    alert('Hey'+' '+UserName+'! come here, there\'s free games! just click that button right there');//seller talk start
    alert('AAAH! this wasn\'t supposed to happen!');//Red talk start
    alert('Hello young one, It appears I\'m in quite the pickle, help me and I\'ll help you. Huh... what\'s BLUE doing?');
    bg.src='../images/RanbowFwens_BG.png';
    loops()
}, 3000);

const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
let DPR=Math.max(1,window.devicePixelRatio||1);

function resize(){
canvas.width =innerWidth * DPR;
canvas.height=innerHeight * DPR;
canvas.style.width =innerWidth+'px';
canvas.style.height=innerHeight+'px';
ctx.setTransform(DPR,0,0,DPR,0,0);
}resize();window.addEventListener('resize',resize);

//Screen: width=0,1279, height=0,730

//player
const targetGlow=new Image();
targetGlow.src='../images/RanbowFwens_player_target_glow.png';
let player={x:180,y:108,w:63,h:55}
const playerSprite=new Image();
playerSprite.src='../images/Player.png';

//enemies
let blue={x:-68,y:-105,w:68,h:105};
const blueSprite=new Image();
blueSprite.src='../images/BlueEnemy.png';

var targetX;var targetY;
let green={x:-90,y:-112,w:90,h:112};
const greenSprite=new Image();
greenSprite.src='../images/GreenEnemy.png';
//fix orange and purple sizes later
let orange={x:-77,y:-94,w:77,h:94};
const orangeSprite=new Image();
orangeSprite.src='../images/OrangeEnemy.png';

let purple={x:-51,y:-30,w:51,h:30};
const purpleSprite=new Image();
purpleSprite.src='../images/PurpleEnemy.png';
//intro seller
let intro={x:150,y:75,w:48,h:72}
const IntroSprite=new Image();
IntroSprite.src='../images/Seller.png';

//controls
document.addEventListener('keydown', PlayerMove);
let comboKeys={};
document.addEventListener('keydown',e =>{comboKeys[e.code]=true;} );
document.addEventListener('keyup',e =>{comboKeys[e.code]=false;} );

function PlayerMove(e){
    if(ded==0&&end==0){
    if(e.code ==='KeyA'){player.x=player.x- 3}//left
if(e.code === 'KeyD'){player.x=player.x+ 3}//right
if(e.code==='KeyW'){player.y=player.y- 3}//up
if(e.code==='KeyS'){player.y=player.y+ 3}//down

if(comboKeys['KeyW']&&comboKeys['KeyA']){player.x=player.x- 3;player.y=player.y- 3}//UpLeft
if(comboKeys['KeyW']&&comboKeys['KeyD']){player.x=player.x+ 3;player.y=player.y- 3}//UpRight
if(comboKeys['KeyS']&&comboKeys['KeyA']){player.x=player.x- 3;player.y=player.y+ 3}//DownLeft
if(comboKeys['KeyS']&&comboKeys['KeyD']){player.x=player.x+ 3;player.y=player.y+ 3}//DownRight

//game border   x={0-1302},y={0-720}
if(player.x<0){player.x=0}
if(player.x>1302){player.x=1302}
if(player.y<0){player.y=0}
if(player.y>720){player.y=720}}
else{player.x=-200;player.y=-200}}
let greenTargetCheck=0;
//timers
let timerType=1;
function Timer1(){timer=timer-1;
    if(timer<0&&timerType==1){
alert("well at least I have legs... Oh yeah green can\'t see so just don\'t get close to him he won\'t kill you...most likely");
enemy='green';blue.x=-100;blue.y=-100;timer=4800;timerType=2;border=0;targetX=player.x;targetY=player.y}}

function Timer2(){timer=timer-1;
    if(timer<0 && timerType==2){
        alert('Thank you for getting my thorax back! Stay out of Orange\'s way and he won\'t kill you');
enemy='orange';green.x=-100;green.y=-100;timer=6600;timerType=3;orangePath=0}}

function Timer3(){timer=timer-1;
    if(timer<0 && timerType==3){
alert('Yay I have arms but my head still feels weird.Purple can go through the vents to catch you so good luck!');
enemy='purple';orange.x=-100;orange.y=-100;timer=1800;timerType=4;}}

function Timer4(){timer=timer-1;
    if(timer<0 && timerType==4){
alert('Congrats on living');
enemy='end';purple.x=-100;purple.y=-100;timer=30000;timerType=5;end=1}}

let GreenTimer=180;let PurpleTimer=30;let orangePath=4;
function enemyMove(){
    if(end==0){
if(ded>0){[blue.x,blue.y,green.x,green.y,orange.x,orange.y,purple.x,purple.y,player.x,player.y]=[-100,-100,-100,-100,-100,-100,
-100,-100,-200,-200]}

if(enemy==='blue'){if(player.x>blue.x){blue.x=blue.x+1} 
else if(player.x<blue.x){blue.x=blue.x-1}
if(player.y>blue.y){blue.y=blue.y+1} 
else if(player.y<blue.y){blue.y=blue.y-1}}

if(border=='1'){if(blue.x<0){blue.x=0};
if(blue.x>1300){blue.x=1300};
if(blue.y<0){blue.y=0};
if(blue.y>671){blue.y=671}}

if(enemy==='green'){if(greenTargetCheck==1){targetX=Math.random()*1287.5;targetY=Math.random()*675;greenTargetCheck=0}
if(greenTargetCheck==0){if(GreenTimer>0){GreenTimer=GreenTimer-1}else{GreenTimer=300;greenTargetCheck=1}}
//check if at target
let tx=targetX-green.x;let ty=targetY-green.y;
if(Math.sqrt(tx*tx+ty*ty)<5){targetX=Math.random()*1287.5;
targetY=Math.random()*675;}

if(targetX>green.x)green.x+=2.5;
if(targetX<green.x)green.x-=2.5;
if(targetY>green.y)green.y+=2.5;
if(targetY<green.y)green.y-=2.5;}

//166,131=top left target
//1258,131=top right target
//1258,680=bottom right target
//166,680=bottom left target
    //0-291=x,0-261=y}mungus sizes
if(enemy==='orange'){if(orangePath===0){ targetX=21+Math.floor(Math.random()*292);targetY=131;}//set target
      else if(orangePath===1){targetX=1258;targetY=1+Math.floor(Math.random()*262);}
      else if(orangePath===2){targetX=1113+Math.floor(Math.random()*292);targetY=680;}
      else if(orangePath===3){targetX=166;targetY=550+Math.floor(Math.random()*262);}

//change the target
 if(orange.x<312&&orange.y<262&&orangePath==0){orangePath=1}//top left
 if(orange.x>1127&&orange.y<262&&orangePath==1){orangePath=2}//top right
 if(orange.x>1127&&orange.y>549&&orangePath==2){orangePath=3}//bottom right
 if(orange.x<312&&orange.y>549&&orangePath==3){orangePath=0}//bottom left
 
    if(targetX>orange.x){orange.x=orange.x+3}
   if(targetX<orange.x){orange.x=orange.x-3}
    if(targetY>orange.y){orange.y=orange.y+3}
   if(targetY<orange.y){orange.y=orange.y-3}}

if(enemy=='purple'){if(0<PurpleTimer){PurpleTimer=PurpleTimer-1}
 if(PurpleTimer==0){
    if(Math.floor(Math.random()*6)==1){purple.x=(player.x-83)+(Math.random()*166);purple.y=(player.y-58)+(Math.random()*116)}
    else{purple.x=Math.random()*1285;purple.y=Math.random()*675};
PurpleTimer=60;}}}}

function dethChek(){
    let playerCenterX=player.x+player.w/2;
    let playerCenterY=player.y+player.h/2;
    let blueCenterX=blue.x+blue.w/2;
    let blueCenterY=blue.y+blue.h/2;
    let greenCenterX=green.x+green.w/2;
let greenCenterY=green.y+green.h/2;
let orangeCenterX=orange.x+orange.w/2;
let orangeCenterY=orange.y+orange.h/2;
let purpleCenterX=purple.x+purple.w/2;
let purpleCenterY=purple.y+purple.h/2;
//blue
    let dx=playerCenterX-blueCenterX;
    let dy= playerCenterY-blueCenterY;
    let dethRange=Math.sqrt(dx*dx + dy*dy);
    if(dethRange<50&&ded==0){ded=1;border=0;alert("It s33ms yoU'r3 a bit BLUE at your 1oss... It's okay, just try again");}
//green
    let dx2=playerCenterX-greenCenterX;
    let dy2= playerCenterY-greenCenterY;
    let dethRange2=Math.sqrt(dx2*dx2 + dy2*dy2);
    if(dethRange2<50){ded=1;alert("It s33ms you'R3 a bit GREEN at youR loss... It's okay, just tRy aGaiN");}
    //orange
    let dx3=playerCenterX-orangeCenterX;
    let dy3= playerCenterY-orangeCenterY;
    let dethRange3=Math.sqrt(dx3*dx3 + dy3*dy3);
    if(dethRange3<50){ded=1;alert("It s33ms y0u'R3 @ bit ORANGE @t y0uR loss... It's okay, just tRy @G@iN");}
    //purple
    let dx4=playerCenterX-purpleCenterX;
    let dy4= playerCenterY-purpleCenterY;
    let dethRange4=Math.sqrt(dx4*dx4 + dy4*dy4);
    if(dethRange4<50){ded=1;alert("It s33ms yoU'R3 a bit PURPLE at youR 1oss... It's okay, just tRy again");}
}

function images(){
    if(end==0){
    if(ded>0){ded=1.1;bg.src='../images/RanbowFwens_deth.png';enemy=ded}
if(enemy=='end'&&endscreen.complete){ctx.drawImage(endscreen,0,0,1502,920)}
if(bg.complete){ctx.drawImage(bg, 0, 0,1402,920);}
if(bg.src.includes('RanbowFwens_BG.png')){

if(playerSprite.complete){ctx.drawImage(playerSprite,player.x,player.y,player.w,player.h)}
if(blueSprite.complete){ctx.drawImage(blueSprite,blue.x,blue.y,blue.w,blue.h)}
if(greenSprite.complete){ctx.drawImage(greenSprite,green.x,green.y,green.w,green.h)}
if(orangeSprite.complete){ctx.drawImage(orangeSprite,orange.x,orange.y,orange.w,orange.h)}
if(purpleSprite.complete){ctx.drawImage(purpleSprite,purple.x,purple.y,purple.w,purple.h)}
   if(ded==1){ctx.fillStyle='#000000';ctx.fillRect(0,0,canvas.width,canvas.height)}}}
if(endscreen.complete&&end==1){ctx.drawImage(endscreen,0,0,1402,920)}
requestAnimationFrame(images);}

function loops(){if(end==0){
    dethChek();enemyMove();
    if(ded==0){Timer1();Timer2();Timer3();Timer4()}}
    requestAnimationFrame(loops);}
    </script>
</body>
</html>