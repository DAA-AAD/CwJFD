<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>#game{display:block;background:#b90000;width:100vw;height:100vh}</style>
    <title>Rainbow friends</title>
</head>
<body>
    <canvas id='game'></canvas>
<script>
//intro placeholder
let timer=3000;
let admin=1;
if(admin===0){
    let UserName=prompt('Who has returned here?');
    alert('Hey'+' '+UserName+'! come here, there\'s free games! just click that button right there');//seller talk start
    alert('AAAH! this wasn\'t supposed to happen!');//Red talk start
    alert('Hello young one, It appears I\'m in quite the pickle, help me and I\'ll help you. Huh... what\'s BLUE doing?')}
    else if(admin===1){let UserName='Maker'}

const bg=new Image();
bg.src='../pictures/introMungus.png';
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
let DPR=Math.max(1,window.devicePixelRatio||1);

function resize() {
canvas.width  = innerWidth * DPR;
canvas.height = innerHeight * DPR;
canvas.style.width  = innerWidth+'px';
canvas.style.height = innerHeight+'px';
ctx.setTransform(DPR,0,0,DPR,0,0);
}resize();window.addEventListener('resize',resize);

//Screen: width=0,1279, height=0,730

//player
let player={x:180,y:108,w:63,h:55}
const playerSprite=new Image();
playerSprite.src='../pictures/Player.png';
//'x/440'='y/300'(xPos)
//'x/290'='y/150'(yPos)

//enemies
let enemy='blue';
let blue={x:-68,y:-105,w:68,h:105};
const blueSprite=new Image();
blueSprite.src='../pictures/BlueEnemy.png';

var targetX;var targetY;
let green={x:-26,y:-30,w:26,h:30};
const greenSprite=new Image();
greenSprite.src='../pictures/GreenEnemy.png';

let orange={x:-20,y:-27,w:20,h:27};
const orangeSprite=new Image();
orangeSprite.src='../pictures/OrangeEnemy.png';

let purple={x:-20,y:-17,w:20,h:17};
const purpleSprite=new Image();
purpleSprite.src='../pictures/PurpleEnemy.png';


//intro seller
let intro={x:150,y:75,w:48,h:72}
const IntroSprite=new Image();
IntroSprite.src='../pictures/Seller.png';
IntroSprite.onload=function(){images();};

//controls

document.addEventListener('keydown', PlayerMove);
let comboKeys={};
document.addEventListener('keydown',e =>{comboKeys[e.code] = true;} );
document.addEventListener('keyup',e =>{comboKeys[e.code] = false;} );

function PlayerMove(e) {
    if (e.code ==='KeyA') {player.x=player.x-3}//left
if (e.code === 'KeyD') {player.x=player.x+3}//right
if(e.code==='KeyW'){player.y=player.y-3}//up
if(e.code==='KeyS'){player.y=player.y+3}//down

if(comboKeys['KeyW']&&comboKeys['KeyA']){player.x=player.x-3;player.y=player.y-3}//UpLeft
if(comboKeys['KeyW']&&comboKeys['KeyD']){player.x=player.x+3;player.y=player.y-3}//UpRight
if(comboKeys['KeyS']&&comboKeys['KeyA']){player.x=player.x-3;player.y=player.y+3}//DownLeft
if(comboKeys['KeyS']&&comboKeys['KeyD']){player.x=player.x+3;player.y=player.y+3}//DownRight

if(player.x<0){player.x=0} else if(player.x>1279){player.x=1279} else if(player.y<0){player.y=0} else if(player.y>720){
    player.y=720}}

function SurviveTimer(){
    timer=timer-1;
    if(timer<0){
alert('You Live');enemy='green';blue.x=-100;blue.y=-100;timer=0}}//placeholder text

function enemyMove(){
if(enemy==='blue'){if(player.x>blue.x){blue.x=blue.x+1} else if(player.x<blue.x){blue.x=blue.x-1}
if(player.y>blue.y){blue.y=(blue.y+1)} else if(player.y<blue.y){(blue.y=blue.y-1)}}

if(enemy==='green'){
setTimeout(()=>{targetX=Math.floor(Math.random()*268);targetY=Math.floor(Math.random()*127)},2000)}
if(enemy==='green'){
    if(targetX>green.x){green.x=green.x+0.5} else if(targetX<green.x){green.x=green.x-0.5} else if(targetY>green.y){
        green.y=green.y-0.5} else if(green.y>targetY){green.y=green.y-0.5}}}

let ded=0;
function dethChek(){let playerCenterX=player.x+player.w/2;
    let playerCenterY=player.y+player.h/2;
    let blueCenterX=blue.x+blue.w/2;
    let blueCenterY=blue.y+blue.h/2;
    
    let dx=playerCenterX-blueCenterX;
    let dy= playerCenterY-blueCenterY;
    let dethRange=Math.sqrt(dx*dx + dy*dy);
    if(dethRange<50){ded = 1;alert("It seems you're a bit BLUE at your loss... It's okay, just try again");}}

function images(){
    if (bg.complete) {ctx.drawImage(bg, 0, 0, 1379,830);}
    if(playerSprite.complete){ctx.drawImage(playerSprite,player.x,player.y,player.w,player.h)}
    if(blueSprite.complete){ctx.drawImage(blueSprite,blue.x,blue.y,blue.w,blue.h)}
if(greenSprite.complete){ctx.drawImage(greenSprite,green.x,green.y,green.w,green.h)}
if(orangeSprite.complete){ctx.drawImage(orangeSprite,orange.x,orange.y,orange.w,orange.h)}
if(purpleSprite.complete){ctx.drawImage(purpleSprite,purple.x,purple.y,purple.w,purple.h)}

    //if(IntroSprite.complete){ctx.drawImage(IntroSprite,intro.x,intro.y,intro.w,intro.h)}
   if(ded==1){ctx.fillStyle='#000000';ctx.fillRect(0,0,canvas.width,canvas.height)}}

function loops(){images();dethChek();enemyMove();SurviveTimer();
    requestAnimationFrame(loops);}loops()

//finish setting up transition to next enemy

    </script>
</body>
</html>